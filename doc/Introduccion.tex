\chapter*{Introducción}
\addcontentsline{toc}{chapter}{Introducción}

Las \href{https://www.imo-official.org/}{Olimpiadas Internacionales de
  Matemáticas (IMO)}\footnote{\url{https://www.imo-official.org}} son
probablemente la competición de ejercicios de inteligencia con mayor
número de celebraciones en el mundo y es por eso que se encuentra entre
los últimos grandes objetivos de la Inteligencia Artificial.

En el proyecto
\href{https://imo-grand-challenge.github.io/}{IMO Grand Challenge}
se plantea construir un sistema de Inteligencia Artificial que sea capaz
de ganar la medalla de oro en esta competición.

Con el objetivo de eliminar la ambigüedad que existe a la hora de
comprobar si las diversas soluciones propuestas a los ejercicios son
correctas o no y qué puntación hay que concederle a cada una, se plantea
la variante de las IMO que se conoce como formal--to--formal (F2F),
\cite{challenge}. Básicamente, esta variante consiste en que recibe el
enunciado y la solución al problema, ambos formalizados en Lean y
comprueba si la solución proporcionada es correcta o no según las reglas
estipuladas.

Lean es un demostrador interactivo, mediante el cual se pueden comprobar
si los resultados o demostraciones que se proponen a un problema son
correctas. Esta herramienta es muy útil pues hay situaciones en las que
a los humanos se nos puede olvidar comentar un aspecto trivial de la
demostración pero el cual es indispensable para la correcta
compresión. Asimismo, hay situaciones en las que por motivos de
extensión o complejidad se hace casi imposible poder realizar la
comprobación correspondiente. En la actualidad, los demostradores
interactivos son un tema muy a la orden del día y que en los últimos
tiempos se ha convertido en una herramienta muy importante, como se
comenta en \cite{ART2}.

De esta manera, se tiene que el reto que se quiere conseguir consiste en
crear un sistema inteligente que sea capaz de obtener la puntuación en
F2F necesaria para alcanzar la medalla de oro en la competición, en el
caso de competir contra humanos.

Como consecuencia de todo esto, actualmente se están desarrollando
multitud de trabajos y proyectos que se basan en la formalización de
diversos problemas (no sólo de las IMO, también de otras competiciones)
con ayuda de diferentes demostradores interactivos como Lean o
Isabelle/HOL.

El proyecto MiniF2F, \cite{mini}, ha comenzado a desarrollarse hace muy
poco tiempo y consiste en formalizar problemas correspondientes a
diferentes competiciones como las IMO pero también otras como American
Mathematics Competitions (AMC). Asimismo, se propone la formalización de
problemas de matemáticas de nivel escolar. En este proyecto las
formalizaciones que se proponen son a través de varias herramientas,
entre ellas Lean.

En el trabajo que aquí se propone, se estudia detalladamente diversas
formalizaciones en Lean de problemas matemáticos correspondientes a las
IMO. Para llevar a cabo este trabajo nos hemos basado en el artículo
\cite{ART} en el que estudiantes de la Universidad de Belgrado
estudiaron de manera teórica y formalizaron en el programa Isabelle/HOL
problemas de las IMO.

El trabajo se ha comenzando con una \textbf{introducción a Lean},
(\ref{cap1}), donde se ha descrito brevemente esta herramienta y también
su librería matemática \textbf{mathlib}. Asimismo, en este capítulo se
desarrolla la \textbf{formalización de una prueba} de manera muy
detallada: explicando y justificando cada paso de la formalización, para
que de esta manera se pueda comprender la estructura de las
formalizaciones.

A continuación, en el capítulo llamado \textbf{elementos de matemáticas
  en Lean}, (\ref{cap2}), se plantean varias formalizaciones sobre lemas
o teoremas que han sido estudiados en asignaturas de formación básica
correspondientes al Grado en Matemáticas de la Universidad de Sevilla.
En concreto, los resultados son de las asignaturas de Cálculo
Infinitesimal y Álgebra Básica. Estas formalizaciones fueron obtenidas
con ayuda del tutorial \cite{tutor} que realicé junto con
\href{https://www.ma.imperial.ac.uk/~buzzard/xena/natural_number_game/}{The
  Natural Number Game}\footnote{The Natural Number Game es un curso en
  el que se explica la teoría de los números naturales diseñada a modo
  de juego de manera que a medida que avanzas en él se introducen más
  técnicas de demostración que se deben ir utilizando.}.

El siguiente capítulo es el más extenso del trabajo y es en el que se
detallan varias \textbf{formalizaciones en Lean de problemas de las IMO}
que ya han sido formalizados con anterioridad (\ref{cap3}). Además de la
correspondiente formalización en Lean, en cada problema se plantea su
resolución en lenguaje natural para que el lector pueda entender y ver
la analogía entre ambas. En concreto se han estudiado los siguientes
problemas que se presentan a continuación:

\textbf{IMO 1959 Q1}

\noindent
Demostrar que la fracción
\[\frac{21⋅n+4}{14⋅n+3}\]
es irreducible para cualquier número natural \(n\).

Probar que una fracción es irreducible es equivalente a demostrar que el
numerador y el denominador de dicha fracción son coprimos entre sí, esto
es, que el máximo común divisor que estos poseen es \(1\). Esta es la
demostración que se plantea en el trabajo.

La demostración se puede dividir en dos partes principales:
\begin{itemize}
\item En primer lugar, se prueba que si existe un número natural \(k\)
  que divide al numerador y que también divide al denominador, entonces
  dicho número \(k\) divide a \(1\). Esta prueba se formaliza en Lean
  mediante un lema auxiliar.

\item En segundo lugar, una vez ya se tiene que el divisor común del
  numerador y el denominador divide a \(1\), se puede concluir el
  resultado deseado muy fácilmente: basta con usar un lema que se
  encuentra en una de las librerías de mathlib.
\end{itemize}

Como se verá en la sección \ref{q159} del trabajo de manera más
detallada, el teorema principal mediante el cual se ha formalizado el
ejercicio en Lean, es el que se presenta a continuación:
\begin{leancode}
theorem imo1959_q1 : ∀ n : ℕ, coprime (21 * n + 4) (14 * n + 3)
\end{leancode}

Asimismo, como se ha comentado, en la formalización de este resultado se
ha hecho uso de un lema auxiliar y es el que nos dice que si existe un
número \(k\) que divida al numerador y al denominador de la fracción,
entonces dicho número divide a \(1\). Su formalización en Lean ha sido
necesaria para la conclusión del ejercicio y es la siguiente:
\begin{leancode}
lemma Auxiliar
  (n k : ℕ)
  (h1 : k ∣ 21 * n + 4)
  (h2 : k ∣ 14 * n + 3)
  : k ∣ 1
\end{leancode}

\textbf{IMO 1962 Q4}

\noindent
Resolver la ecuación
\begin{equation}\label{ecuacionq4}
  \cos²(x)+\cos²(2x)+\cos²(3x)=1.
\end{equation}

Este problema ha sido probablemente el más laborioso del trabajo: ha
sido necesario demostrar y formalizar varios resultados y definiciones
auxiliares.

En primer lugar se ha definido la propiedad \textbf{problema} para
referirnos a la ecuación que se quiere resolver, esto es,
(\ref{ecuacionq4}). En Lean esto se ha formalizado de la siguiente
manera:
\begin{leancode}
def problema (x : R) : Prop :=
  cos x ^ 2 + cos (2 * x) ^ 2 + cos (3 * x) ^ 2 = 1
\end{leancode}

A continuación, se ha definido una función que hemos notado como
\textbf{funAuxiliar} y que viene dada por la siguiente expresión:
\begin{equation}\label{introaux}
  \text{funAuxiliar}(x)=\cos(x)·\left(\cos²(x)-\frac{1}{2}\right)·\cos(3x)
\end{equation}

Esta definición se ha formalizado en Lean como:
\begin{leancode}
def funauxiliar (x : ℝ) : ℝ :=
  cos x * (cos x ^ 2 - 1/2) * cos (3 * x)
\end{leancode}

El siguiente paso en la demostración, ha consistido en probar que
resolver la ecuación que nos interesa es equivalente a resolver la
expresión obtenida de igualar (\ref{introaux}) a cero. En Lean esto lo
hemos formalizado con el siguiente lema auxiliar:
\begin{leancode}
lemma Equivalencia
  {x : ℝ}
  : problema x ↔ funauxiliar x = 0
\end{leancode}

Luego, se ha resuelto el problema equivalente. Se puede observar que
como la \textbf{funAuxiliar} está factorizada e igualada a cero, hallar
las correspondientes soluciones no es nada complicado. Es más, los dos
casos en los que se verificará dicha ecuación será:
\begin{itemize}
\item El coseno al cuadrado de \(x\) sea igual a un medio.

\item El coseno de \(3x\) sea nulo.
\end{itemize}

Esta casuística ha sido formalizada en Lean a través del siguiente lema:
\begin{leancode}
lemma CasosSolucion
  {x : R}
  : funauxiliar x = 0 ↔ cos x ^ 2 = 1/2 ∨ cos (3 * x) = 0
\end{leancode}

Una vez ya se ha demostrado en qué dos casos se verifica la expresión
para resolver el problema, se ha estudiado cuáles son los números \(x\)
que verifican dicha expresión. Esto se ha hecho con la formalización de
los dos siguientes lemas:
\begin{leancode}
lemma SolucionCosenoCuadrado
  {x : R}
  : cos x ^ 2 = 1/2 ↔ ∃ k : Z, x = (2 * k + 1) * π / 4

lemma SolucionCosenoTriple
  {x : R}
  : cos (3 * x) = 0 ↔ ∃ k : Z, x = (2 * k + 1) * π / 6
\end{leancode}

Se puede observar que al estar trabajando con funciones trigonométricas,
los valores para los que se verifican las diferentes igualdades son bien
conocidos.  Por tanto, se tiene ahora que definiendo el conjunto formado
por todos los números que verifican una de las dos posibilidades
planteadas ya se tendría el conjunto de soluciones del problema. La
formalización de dicho conjunto es la siguiente:
\begin{leancode}
def Solucion : set R :=
  {x : R | ∃ k : Z, x = (2 * k + 1) * π / 4 ∨ x = (2 * k + 1) * π / 6}
\end{leancode}

Finalmente, ya se tiene la conclusión del ejercicio y es que el conjunto
de soluciones del problema se corresponde con el definido justo
antes. En Lean se ha formalizado de la siguiente manera:

\begin{leancode}
theorem imo1962_q4
  {x : ℝ}
  : problema x ↔ x ∈ Solucion
\end{leancode}

\textbf{IMO 1977 Q6}

\noindent
Considere la función
\(f:ℕ⁺ → ℕ⁺\) satisfaciendo que
\[f(f(n)) < f(n+1)\]
para cualquier número \(n\). Probar que para todo número
natural positivo \(n\) se verifica que
\[f(n) = n.\]

El correspondiente enunciado en Lean ha sido formalizado de la siguiente
manera:
\begin{leancode}
theorem imo1977_q6
  (f : ℕ+ → ℕ+)
  (h : ∀ n, f (f n) < f (n + 1))
  : ∀ n, f n = n
\end{leancode}

Para llevar a cabo la demostración de este resultado sólo ha sido
necesario el uso de un teorema auxiliar. Este teorema consiste en probar
el mismo resultado que se plantea inicialmente y bajo las mismas
hipótesis pero considerando que la función \(f\) está definida del
conjunto de los naturales al conjunto de los naturales (es decir, no
tienen porqué ser positivos). En Lean esto se ha formalizado como sigue:
\begin{leancode}
theorem Extension
  (f : ℕ → ℕ)
  (h1 : ∀ n, f (f n) < f (n + 1))
  : ∀ n, f n = n
\end{leancode}

Finalmente, para concluir el problema que deseamos basta con aplicar el
teorema que acabamos de detallar sobre la siguiente función:
 \begin{equation}
    f_1(m)=\left\lbrace\begin{array}{ll}
                         f(m), & \text{si } m>0, \\
                         0, & \text{si } m=0.
                       \end{array}\right.
\end{equation}

Destacar que para poder aplicar dicho teorema, previamente ha sido
necesario probar que la función así definida verifica las hipótesis del
teorema, lo cual se comprueba de manera muy sencilla diferenciando por
casos.

\textbf{IMO 2001 Q2}

\noindent
Consideremos \(a\), \(b\) y \(c\) tres números reales positivos
cualesquiera. Demostrar que
\begin{equation}\label{introq2}
  \frac{a}{\sqrt{a²+8bc}} +
  \frac{b}{\sqrt{b²+8ca}} +
  \frac{c}{\sqrt{c²+8ab}} ≥ 1.
\end{equation}

La formalización en Lean del enunciado del teorema es bastante directa:

\begin{leancode}
theorem imo2001_q2
  (ha : 0 < a)
  (hb : 0 < b)
  (hc : 0 < c)
  : 1 ≤ a / sqrt (a ^ 2 + 8 * b * c) +
        b / sqrt (b ^ 2 + 8 * c * a) +
        c / sqrt (c ^ 2 + 8 * a * b)
\end{leancode}

Para formalizar este resultado sólo ha sido necesario el uso de un
teorema auxiliar. No obstante, mencionar que para demostrar el teorema
auxiliar han sido necesarios a su vez otros dos lemas.

El teorema auxiliar mediante el cual se ha podido resolver el último
ejercicio del capítulo consiste en probar que bajo las hipótesis del
problema se tiene la siguiente desigualdad:
\begin{equation}\label{introteoraux}
   1 ≤ \frac{a³}{\sqrt{(a³)²+8b³c³}}+\frac{b³}{\sqrt{(b³)²+8c³a³}}+
    \frac{c³}{\sqrt{(c³)²+8a³b³}}.
\end{equation}

En Lean este resultado lo hemos formalizado de la siguiente manera:
\begin{leancode}
theorem imo2001_q2_aux
  (ha : 0 < a)
  (hb : 0 < b)
  (hc : 0 < c)
  : 1 ≤ a ^ 3 / sqrt ((a ^ 3) ^ 2 + 8 * b ^ 3 * c ^ 3) +
        b ^ 3 / sqrt ((b ^ 3) ^ 2 + 8 * c ^ 3 * a ^ 3) +
        c ^ 3 / sqrt ((c ^ 3) ^ 2 + 8 * a ^ 3 * b ^ 3)
\end{leancode}

Si se observan de manera detallada las expresiones (\ref{introq2}) y
(\ref{introteoraux}), se tiene que considerando los números reales
\((a^{3})^{-1}\), \((b^{3})^{-1}\) y \((c^{3})^{-1}\) en
(\ref{introteoraux}) se llega directamente a (\ref{introq2}).

Todos estos capítulos que se han desarrollado previamente, han permitido
adquirir los conocimientos y la destreza suficiente como para formalizar
un problema que no haya sido formalizado con anterioridad. Entonces, en
el último capítulo del trabajo se ha llevado a cabo la
\textbf{formalización en Lean de un nuevo problema que no se había
formalizadoantes}, (\ref{cap4}). En concreto, el problema que se ha
formalizado en este capítulo es el Q6 correspondiente al año 2001. El
problema que en este capítulo se ha estudiado posee el siguiente
enunciado:

\noindent
Sean \(a\), \(b\), \(c\) y \(d\) cuatro números enteros tales que
\(a > b > c > d > 0\). Supongamos que
\begin{equation}\label{introhipotesis}\tag{h}
  ac+bd = (a+b-c+d)(-a+b+c+d).
\end{equation}
Demostrar que \(ab+cd\) no es primo.

Asimismo, la formalización que se ha propuesto en el trabajo para
resolver el problema que es la siguiente:

\begin{leancode}
theorem imo2001q6
  (hd  : 0 < d)
  (hdc : d < c)
  (hcb : c < b)
  (hba : b < a)
  (h : a*c + b*d = (a + b - c + d)*(-a + b + c + d))
  : ¬ prime (a*b + c*d)
\end{leancode}

Para llevar acabo tal formalización en Lean he hecho uso de cinco lemas
auxiliares. Expangamos estos cinco resultados:
\begin{enumerate}
\item Bajo la hipótesis (\ref{introhipotesis}) del problema, se tiene
  que los cuatro números enteros descritos verifican la siguiente
  igualdad:
  \begin{equation*}
    b²+bd+d²=a²-ac+c².
  \end{equation*}

  Cuyo enunciado en Lean se formaliza como sigue:
  \begin{leancode}
  lemma sumas_equivalentes
    (h : a*c + b*d = (a + b - c + d) * (-a + b + c + d))
    : b^2 + b*d + d^2 = a^2 - a*c + c^2
  \end{leancode}

\item Bajos la misma hipótesis (\ref{introhipotesis}) del problema,
  probamos que los cuatro números enteros descritos verifican la
  siguiente expresión:
  \begin{equation*}
    (ac+bd)(b²+bd+d²)=(ab+cd)(ad+bc).
  \end{equation*}

  Asimismo, la correspondiente formalización en Lean de este resultado
  es:
  \begin{leancode}
  lemma productos_equivalentes
    (h : a*c + b*d = (a + b - c + d) * (-a + b + c + d))
    : (a*c + b*d) * (b^2 + b*d + d^2) = (a*b + c*d) * (a*d + b*c)
  \end{leancode}

\item Bajo todas las hipótesis del problema inicial, se verifica la
  siguiente desigualdad:
  \begin{equation*}
    ac+bd<ab+cd.
  \end{equation*}

  Cuya formalización en Lean es:
  \begin{leancode}
  lemma desigualdad_auxiliar1
    (hba : b < a)
    (hcb : c < b)
    (hdc : d < c)
    (h : a*c + b*d = (a + b - c + d) * (-a + b + c + d))
    : a*c + b*d < a*b + c*d:
  \end{leancode}

\item Análogamente a la desigualdad anterior, también se demuestra que:
  \begin{equation*}
    ad+bc<ac+bd.
  \end{equation*}

  Y en este caso la formalización del enunciado en Lean es:
  \begin{leancode}
  lemma desigualdad_auxiliar2
    (hba : b < a)
    (hdc : d < c)
    (h : a*c + b*d = (a + b - c + d)*(-a + b + c + d))
    : a*d + b*c < a*c + b*d:=
    by nlinarith
  \end{leancode}

\item El último resultado es inmediato a partir del segundo que hemos
  enunciado, y es que se tiene que el número \(ac+bd\) divide al
  producto de los números \(ab+cd\) y \(ad+bc\).

  Esto lo hemos formalizado en Lean de la siguiente manera:

  \begin{leancode}
  lemma division
    (h : a*c + b*d = (a + b - c + d) * (-a + b + c + d))
    : a*c + b*d ∣ (a*b+c*d) * (a*d+b*c)
  \end{leancode}

\end{enumerate}

Entonces, tras detallar los resultados auxiliares que han sido usados,
se tiene que la demostración del teorema principal se hace por
contradicción, suponiendo que el número \(ab+cd\) sí es primo y llegando
entonces a una contradicción.

Para llegar a tal contradicción, se usa que por el quinto resultado
auxiliar se tiene que \(ac+bd\) divide al producto de \(ab+cd\) con
\(ad+bc\) y también se tiene la hipótesis de que \(ab+cd\) es
primo. Entonces, sabemos que se ha de verificar una de las dos
siguientes posibilidades:
\begin{itemize}
\item Que \(ab+cd\) divida a \(ac+bd\).

\item O bien que \(ac+bd\) divida a \(ad+bc\).
\end{itemize}

Estudiando ambas posibilidades se llega a contradicción como
consecuencia de las dos desigualdades que se han introducido en los
resultados auxiliares.

Finalmente, en el apéndice \ref{apentacti} se han explicado todas
las tácticas de Lean que se han usado en el trabajo y en el índice de
lemas se han indicado los lemas usados.

\comentario{Se confunden las referencias a las ecuaciones y a los
  diferentes capítulos}

\comentario{Quedaría mejor una distinción de secciones. Por ejemplo
  cuando decimos "Todos estos capítulos que se han desarrollado
  previamente..." no sé si está muy seguido de la conclusión de los
  problemas}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "IMO_en_Lean"
%%% End:
